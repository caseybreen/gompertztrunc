[{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"vignette gives overview gompertztrunc package presents three case-studies illustrating package’s functionality. goal vignette give users high-level overview using gompertztrunc package mortality estimation including use weights, specification visualization models, limitations approach.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"background","dir":"Articles","previous_headings":"","what":"Background","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"Researchers increasingly access administrative mortality records include died limited observation window without information survivors. double truncation absence denominators precludes use conventional tools survival analysis. gompertztrunc package includes tools mortality estimation doubly-truncated datasets without population denominators.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"summary-of-parametric-gompertz-approach","dir":"Articles","previous_headings":"","what":"Summary of Parametric Gompertz Approach","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"method assumes mortality follows parametric model Gompertz model uses maximum likelihood methods estimate underlying mortality distribution. Specifically, hazard individual \\(\\) age \\(x\\) given parameters \\(\\beta\\) given \\[h_i(x | \\beta) = a_0 e^{b_0 x} e^{\\beta Z_i}\\] \\(h(x)\\) hazard age \\(x\\) \\(a_0\\) baseline level mortality \\(b_0\\) gives rate increase mortality \\(Z_i\\) covariates person \\(\\) (e.g., years education, place birth) \\(\\beta\\) set parameters model estimate values \\(\\widehat{}\\), \\(\\widehat{b}\\), \\(\\widehat{\\beta}\\). main function package gompertztrunc::gompertz_mle function, takes following arguments: formula: model formula (example, death_age ~ educ_yrs + homeownership) left_trunc: year upper truncation right_trunc: year lower truncation data: data frame age death variable covariates byear: year birth maxiter maximum number iteration optim function weights person-level weight","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"First, load gompertztrunc package Github.","code":"## install gompertztrunc package from Github # install.packages(\"devtools\") # devtools::install_github(\"caseybreen/gompertztrunc\") ## library packages library(gompertztrunc)         ## calculate mortality differentials under double-truncation   library(tidyverse)             ## data manipulation and visualization   library(data.table)            ## fast data manipulation library(cowplot)               ## publication-ready themes for ggplot library(socviz)                ## helper functions for data visualization (Kieran Healy)   library(broom)                 ## \"tidy\" model output    ## load data  sim_data <- sim_data             ## simulated  bunmd_demo <- bunmd_demo         ## real  numident_demo <- numident_demo   ## real"},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"case-study-i-simulated-data","dir":"Articles","previous_headings":"","what":"Case Study I: Simulated Data","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"first case study, use simulated (fake) data included gompertztrunc package. simulated data, know true coefficient values (also know mortality follows Gompertz distribution proportional hazards assumption holds). Now let’s try running gompertz_mle() function simulated data: gompertz_mle() function returns list contains three elements: initial starting parameters MLE routine. starting parameter found using OLS regression age death full optim object, gives details optimization routine (e.g., whether model converged) data.frame containing results: estimated Gompertz parameters, coefficients, hazards ratios 95% confidence intervals. recommend always checking full optim object make sure model converged. first column gives Gompertz \\(b\\) parameter, second row gives Gompertz mode. next three rows show covariate’s estimated coefficient associate hazard ratio. hazard ratio compares ratio hazard rate population strata (e.g., treated group) population baseline (.e., control group). hazard ratio 1 suggests higher risk ages hazard ratio 1 suggests smaller mortality risk ages (assuming proportional hazards). investigators ultimately report hazard ratios, translating hazard ratios differences life expectancy may help facilitate interpretation comparison studies. included functionality gompertztrunc package:","code":"## Look at simulated data  head(sim_data) ##    aod byear dyear       temp sex isSouth ## 1:  87  1810  1897 -4.6198501   1       0 ## 2:  78  1810  1888 -0.8841613   1       0 ## 3:  79  1810  1890  0.7566703   1       0 ## 4:  85  1810  1895 -0.6728037   1       0 ## 5:  85  1810  1896 -3.8537981   1       0 ## 6:  81  1810  1891 -1.2885393   1       0 ## What years do we have mortality coverage?  sim_data %>%    summarize(min(dyear), max(dyear)) ##   min(dyear) max(dyear) ## 1       1888       1905 ## run gompertz_mle function   ## returns a list  simulated_example <- gompertz_mle(formula = aod ~ temp + as.factor(sex) + isSouth,                                                  left_trunc = 1888,                                                  right_trunc = 1905,                                                  data = sim_data) ## 1. starting value for coefficients (from linear regression) simulated_example$starting_values ##     log.b.start        b0.start            temp as.factor(sex)1         isSouth  ##     -2.30258509     -9.96897213      0.07505734     -0.18001387      0.22607193 ## 2. optim fit object simulated_example$optim_fit ## $par ##     log.b.start        b0.start            temp as.factor(sex)1         isSouth  ##      -2.2745186      -9.4083999       0.2068584      -0.5300299       0.5983461  ##  ## $value ## [1] 17549.16 ##  ## $counts ## function gradient  ##      886       NA  ##  ## $convergence ## [1] 0 ##  ## $message ## NULL ##  ## $hessian ##                 log.b.start  b0.start       temp as.factor(sex)1   isSouth ## log.b.start       283845.66 35822.202 -36549.785       20205.368 14017.009 ## b0.start           35822.20  4536.154  -4552.676        2553.982  1783.017 ## temp              -36549.79 -4552.676  32378.684       -1569.926 -3199.463 ## as.factor(sex)1    20205.37  2553.982  -1569.926        2553.949  1109.978 ## isSouth            14017.01  1783.017  -3199.463        1109.978  1783.000 ## 2. check model convergence (0 == convergence) simulated_example$optim_fit$convergence ## [1] 0 ## 3. Look at model results  simulated_example$results ## # A tibble: 5 × 7 ##   parameter         coef coef_lower coef_upper     hr hr_lower hr_upper ##   <chr>            <dbl>      <dbl>      <dbl>  <dbl>    <dbl>    <dbl> ## 1 gompertz_b       0.103     0.0964      0.110 NA       NA       NA     ## 2 gompertz_mode   69.4      64.4        74.3   NA       NA       NA     ## 3 temp             0.207     0.194       0.219  1.23     1.21     1.25  ## 4 as.factor(sex)1 -0.530    -0.590      -0.470  0.589    0.554    0.625 ## 5 isSouth          0.598     0.536       0.661  1.82     1.71     1.94 ## true coefficient values (we know bc we simulated them) mycoefs <- c(\"temp\" = +.2, \"sex\" = -.5, \"isSouth\" = +.6)  ## compare our estimated values to true value  ## we can only do this because this is simulated (fake) data   simulated_example$results %>%   filter(!stringr::str_detect(parameter, \"gompertz\")) %>%   mutate(true_coef = mycoefs) %>%   select(parameter, coef, coef_lower, coef_upper, true_coef) ## # A tibble: 3 × 5 ##   parameter         coef coef_lower coef_upper true_coef ##   <chr>            <dbl>      <dbl>      <dbl>     <dbl> ## 1 temp             0.207      0.194      0.219       0.2 ## 2 as.factor(sex)1 -0.530     -0.590     -0.470      -0.5 ## 3 isSouth          0.598      0.536      0.661       0.6 ## translate hazard rates to difference in e65 convert_hazards_to_ex(simulated_example$results, age = 65, use_model_estimates = T) %>%    select(parameter, hr, hr_lower, hr_upper, e65, e65_lower, e65_upper) ## # A tibble: 3 × 7 ##   parameter          hr hr_lower hr_upper    e65 e65_lower e65_upper ##   <chr>           <dbl>    <dbl>    <dbl>  <dbl>     <dbl>     <dbl> ## 1 temp            1.23     1.21     1.25  -0.966     -1.02    -0.910 ## 2 as.factor(sex)1 0.589    0.554    0.625  2.84       2.49     3.20  ## 3 isSouth         1.82     1.71     1.94  -2.57      -2.80    -2.33"},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"case-study-ii-real-world-example-with-bunmd-data","dir":"Articles","previous_headings":"","what":"Case Study II: Real-World Example with BUNMD Data","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"second case study, look mortality advantage foreign-born. use demo dataset Berkeley Unified Numident Mortality Database (BUNMD). First, let’s look distribution deaths country:","code":"## look at data  head(bunmd_demo) ## # A tibble: 6 × 6 ##         ssn bpl_string death_age byear dyear age_first_application ##       <int> <fct>          <int> <int> <int>                 <int> ## 1 267729143 Cuba              89  1912  2002                    49 ## 2 266172087 Cuba              80  1911  1991                    57 ## 3 590072321 Cuba              92  1911  2004                    69 ## 4 265064566 Cuba              76  1913  1989                    53 ## 5 265877097 Cuba              86  1908  1995                    70 ## 6 264745485 Cuba              87  1915  2003                    46 ## how many people per country?  bunmd_demo %>%   count(bpl_string) ## # A tibble: 6 × 2 ##   bpl_string            n ##   <fct>             <int> ## 1 Native Born White 20000 ## 2 Cuba              13194 ## 3 England            7561 ## 4 Italy             15306 ## 5 Mexico            13755 ## 6 Poland            11186 ## distribution of deaths? ggplot(data = bunmd_demo) +    geom_histogram(aes(x = death_age),                  fill = \"grey\",                  color = \"black\",                  binwidth = 1) +    cowplot::theme_cowplot() +    labs(x = \"Age of Death\",        y = \"N\") +    facet_wrap(~bpl_string)"},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"linear-regression-approach","dir":"Articles","previous_headings":"Case Study II: Real-World Example with BUNMD Data","what":"Linear regression approach","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"Let’s look association country origin longevity. First, ’ll try using biased approach (OLS regression age death). Now ’ll perform estimation gompertztrunc package:","code":"## run linear model  lm_bpl <- lm(death_age ~ bpl_string + as.factor(byear), data = bunmd_demo)  ## extract coefficients from model  lm_bpl_tidy <- tidy(lm_bpl) %>%   filter(str_detect(term, \"bpl_string\")) %>%   mutate(term = prefix_strip(term, \"bpl_string\"))  ## rename variables  lm_bpl_tidy <- lm_bpl_tidy %>%   mutate(     e65 = estimate,     e65_lower = estimate - 1.96 * std.error,     e65_upper = estimate + 1.96 * std.error   ) %>%   rename(country = term) %>%   mutate(method = \"Regression on Age of Death\") ## Gompertz Trunc  ## Use 1988-2005 because we are using BUNMD  gompert_mle_results <- gompertz_mle(formula = death_age ~ bpl_string,                                      left_trunc = 1988,                                     right_trunc = 2005,                                     data = bunmd_demo)  ## convert to e65 ## use model estimates — but can also set other defaults for Gompertz M and B.  mle_results <- convert_hazards_to_ex(gompert_mle_results$results, use_model_estimates = T)  ## tidy up results  mle_results <- mle_results %>%    rename(country = parameter) %>%   filter(str_detect(country, \"bpl_string\")) %>%   mutate(country = prefix_strip(country, \"bpl_string\")) %>%   mutate(method = \"Gompertz Parametric Estimate\")  ## look at results  mle_results ## # A tibble: 5 × 11 ##   country   coef coef_lower coef_upper    hr hr_lower hr_upper   e65 e65_lower ##   <chr>    <dbl>      <dbl>      <dbl> <dbl>    <dbl>    <dbl> <dbl>     <dbl> ## 1 Cuba    -0.229     -0.270    -0.188  0.796    0.764    0.829 1.70      1.39  ## 2 England -0.130     -0.179    -0.0815 0.878    0.836    0.922 0.960     0.597 ## 3 Italy   -0.178     -0.217    -0.138  0.837    0.805    0.871 1.31      1.02  ## 4 Mexico  -0.369     -0.412    -0.325  0.692    0.662    0.723 2.77      2.44  ## 5 Poland  -0.185     -0.229    -0.141  0.831    0.795    0.869 1.37      1.04  ## # … with 2 more variables: e65_upper <dbl>, method <chr>"},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"visualize-results","dir":"Articles","previous_headings":"Case Study II: Real-World Example with BUNMD Data","what":"Visualize Results","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"Compare estimates ‘unbiased’ Gompertz MLE method old ‘biased’ method, regression age death.","code":"## combine results from both models  bpl_results <- lm_bpl_tidy %>%   bind_rows(mle_results)  ## Calculate adjustment factor (i.e., how much bigger are Gompertz MLE results) adjustment_factor <- bpl_results %>%    select(country, method, e65) %>%   pivot_wider(names_from = method, values_from = e65) %>%   mutate(adjustment_factor = `Gompertz Parametric Estimate` / `Regression on Age of Death`) %>%   summarize(adjustment_factor_mean = round(mean(adjustment_factor), 3)) %>%   as.vector()  ## Plot results bpl_results %>%   bind_rows(mle_results) %>%   ggplot(aes(y = reorder(country, e65), x = e65, xmin = e65_lower, xmax = e65_upper, color = method)) +   geom_pointrange(position = position_dodge(width = 0.2), shape = 1) +   cowplot::theme_cowplot(font_size = 12) +   geom_vline(xintercept = 0, linetype = \"dashed\") +   theme(legend.position = \"bottom\", legend.title = element_blank()) +   labs(     x = \"Estimate\",     title = \"Foreign-Born Male Ages at Death, BUNMD 1905-1914\",     y = \"\",     subtitle = paste0(\"Gompertz MLE estimates are ~\", adjustment_factor, \" times larger than regression on age of death\")   ) +   scale_color_brewer(palette = \"Set1\") +   annotate(\"text\", label = \"Native Born Whites\", x = 0.1, y = 3, angle = 90, size = 3, color = \"black\")"},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"case-study-iii-education-and-longevity","dir":"Articles","previous_headings":"","what":"Case Study III: Education and longevity","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"third case study, look association education longevity. ’ll use demo dataset CenSoc-Numident file. CenSoc-Numident demo dataset, covariates CenSoc-Numident dataset : educ_yrs: years education urban: urban (1) vs. rural (0) ownhome: home (1) rented N/(0) ’s association 1-year increase education life expectancy 65 (e65)? , every additional year education, hazard ratio falls 4.6% — corresponds additional 0.33 year increase e(65).","code":"## load in file  numident_demo <- numident_demo  ## recode categorical education variable to categorical \"years of education\"  numident_demo <- numident_demo %>%    mutate(educ_yrs = case_when(     educd == \"No schooling completed\" ~ 0,     educd == \"Grade 1\" ~ 1,     educd == \"Grade 2\" ~ 2,     educd == \"Grade 3\" ~ 3,     educd == \"Grade 4\" ~ 4,     educd == \"Grade 5\" ~ 5,     educd == \"Grade 6\" ~ 6,     educd == \"Grade 7\" ~ 7,     educd == \"Grade 8\" ~ 8,     educd == \"Grade 9\" ~ 9,     educd == \"Grade 10\" ~ 10,     educd == \"Grade 11\" ~ 11,     educd == \"Grade 12\" ~ 12,     educd == \"Grade 12\" ~ 12,     educd == \"1 year of college\" ~ 13,     educd == \"2 years of college\" ~ 14,     educd == \"3 years of college\" ~ 15,     educd == \"4 years of college\" ~ 16,     educd == \"5+ years of college\" ~ 17   ))  ## restrict to men  data_numident_men <- numident_demo %>%    filter(sex == \"Male\") %>%    filter(byear %in% 1910:1920 & death_age > 65) ## Example with only one cohort education_gradient <- gompertz_mle(formula = death_age ~ educ_yrs,                                     data = data_numident_men,                                   weights = weight,                                    left_trunc = 1988,                                     right_trunc = 2005)  ## look at results  education_gradient$results   ## look at effect on e65 convert_hazards_to_ex(education_gradient$results, use_model_estimates = T, age = 65)"},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"person-weights","dir":"Articles","previous_headings":"","what":"Person-weights","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":"Gompertztrunc package can incorporate person-level weights. Weights can help adjust differential representation; weight assigned person proportional estimated number persons target population person represents. vector supplied weights must long data, weights must positive. Using new weights, see owning home longer now associated higher mortality rather lower mortality! make sense upweighted people didn’t home died advanced ages. stylized example designed highlight weights change analysis; generally weights dramatic effect research results.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/articles/gompertztrunc_vignette.html","id":"summary-and-limitations","dir":"Articles","previous_headings":"","what":"Summary and Limitations","title":"Analyzing doubly-truncated mortality data using the gompertztrunc package","text":" package can used estimate mortality differentials without population denominators. limitations approach: Gompertz law apply perfectly application, major departures either assumption may bias estimates. approach generally requires larger sample sizes produce reliable estimates. approach assumes proportional hazards: survival curves different strata hazard functions proportional time.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Casey Breen. Author, maintainer. Maria Osborne. Author. Joshua R. Goldstein. Author.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Breen C, Osborne M, Goldstein J (2022). gompertztrunc: gompertztrunc: Tools estimating. R package version 0.1.0, https://caseybreen.github.io/gompertztrunc.","code":"@Manual{,   title = {gompertztrunc: gompertztrunc: Tools for estimating},   author = {Casey Breen and Maria Osborne and Joshua R. Goldstein},   year = {2022},   note = {R package version 0.1.0},   url = {https://caseybreen.github.io/gompertztrunc}, }"},{"path":[]},{"path":"https://caseybreen.github.io/gompertztrunc/readme.html","id":"about-the-package-under-development","dir":"","previous_headings":"","what":"About the package (under development)","title":"gompertztrunc","text":"gompertztrunc R package estimating Gompertz distributions doubly-truncated data using maximum likelihood estimation. install package:","code":"install.packages(\"devtools\") devtools::install_github(\"caseybreen/gompertztrunc\")"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/bM2a.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper functions — bM2a","title":"Helper functions — bM2a","text":"Helper functions","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/bM2a.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper functions — bM2a","text":"","code":"bM2a(b, M)"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/bunmd_demo.html","id":null,"dir":"Reference","previous_headings":"","what":"Demo BUNMD Data Set — bunmd_demo","title":"Demo BUNMD Data Set — bunmd_demo","text":"data set containing sample CenSoc Berkeley Unified Numident Mortality Database (BUNMD) file, including age death select covariates.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/bunmd_demo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Demo BUNMD Data Set — bunmd_demo","text":"","code":"bunmd_demo"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/bunmd_demo.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Demo BUNMD Data Set — bunmd_demo","text":"data frame 81,002 rows 6 variables: ssn Social Security number bpl_string Country birth death_age Age death (integer years) byear Calender year birth dyear Calender year death age_first_application Age first Social Security application","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/convert_hazards_to_ex.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert hazard ratios to life expectancy — convert_hazards_to_ex","title":"Convert hazard ratios to life expectancy — convert_hazards_to_ex","text":"Convert hazard ratios differences remaining life expectancy given age (defaults age 65)","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/convert_hazards_to_ex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert hazard ratios to life expectancy — convert_hazards_to_ex","text":"","code":"convert_hazards_to_ex(   df,   age = 65,   upper_age = 120,   M = 80,   b = 0.075,   use_model_estimates = F )"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/convert_hazards_to_ex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert hazard ratios to life expectancy — convert_hazards_to_ex","text":"df Dataframe results given gompertz_mle() function age Age calculate remaining life expectancy upper_age Maximal age use life table calculation M Gompertz parameter modal age death b Gompertz mortality slope parameter use_model_estimates Use estimates Gompertz Parameters model, rather defaults","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/convert_hazards_to_ex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert hazard ratios to life expectancy — convert_hazards_to_ex","text":"dataframe hazards ratios corresponding e(x) estimates confidence intervals","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/get.par.start.html","id":null,"dir":"Reference","previous_headings":"","what":"Get starting values for parameters — get.par.start","title":"Get starting values for parameters — get.par.start","text":"Uses linear modeling compute initial values MLE optimizer","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/get.par.start.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get starting values for parameters — get.par.start","text":"","code":"get.par.start(formula, data)"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/get.par.start.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get starting values for parameters — get.par.start","text":"formula estimation formula data data matrix y, u, l, covariates, including cohort","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/get.par.start.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get starting values for parameters — get.par.start","text":"Named vector initial parameter estimates","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertz_mle.html","id":null,"dir":"Reference","previous_headings":"","what":"Gompertz MLE function — gompertz_mle","title":"Gompertz MLE function — gompertz_mle","text":"Fits truncated Gompertz distribution proportional hazards mortality data using maximum likelihood estimation.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertz_mle.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gompertz MLE function — gompertz_mle","text":"","code":"gompertz_mle(   formula,   left_trunc = 1975,   right_trunc = 2005,   data,   byear = byear,   dyear = dyear,   lower_age_bound = NULL,   upper_age_bound = NULL,   weights = NULL,   death_age_data_type = \"auto\",   maxiter = 10000 )"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertz_mle.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gompertz MLE function — gompertz_mle","text":"formula estimation formula left_trunc left truncation year right_trunc right truncation year data data frame containing variables model byear vector birth years dyear vector death years lower_age_bound lowest age death include (optional) upper_age_bound highest age death include (optional) weights optional vector individual weights death_age_data_type option handling continuous discrete death age variable (yet implemented) maxiter maximum number iterations optimizer","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertz_mle.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gompertz MLE function — gompertz_mle","text":"Returns named list consisting following components (See stats::optim additional details): starting_values list starting values parameters optim_fit list consisting : par best estimation parameter values value log likelihood counts number calls function gradient convergence returns 0 model converged, values see stats::optim message information returned optimizer hessian Hessian matrix  results table estimates upper/lower bounds","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertz_mle.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gompertz MLE function — gompertz_mle","text":"","code":"#model hazards as function of birthplace using bunmd_demo file gompertz_mle(formula = death_age ~ bpl_string, left_trunc = 1988, right_trunc = 2005, data = bunmd_demo) #> $starting_values #>       log.b.start          b0.start    bpl_stringCuba bpl_stringEngland  #>       -2.30258509      -10.53734176       -0.16960453       -0.08867522  #>   bpl_stringItaly  bpl_stringMexico  bpl_stringPoland  #>       -0.10895325       -0.18448462       -0.10019333  #>  #> $optim_fit #> $optim_fit$par #>       log.b.start          b0.start    bpl_stringCuba bpl_stringEngland  #>        -2.3031755       -10.5167314        -0.2286272        -0.1304346  #>   bpl_stringItaly  bpl_stringMexico  bpl_stringPoland  #>        -0.1775261        -0.3685382        -0.1849352  #>  #> $optim_fit$value #> [1] 218401 #>  #> $optim_fit$counts #> function gradient  #>      836       NA  #>  #> $optim_fit$convergence #> [1] 0 #>  #> $optim_fit$message #> NULL #>  #> $optim_fit$hessian #>                   log.b.start   b0.start bpl_stringCuba bpl_stringEngland #> log.b.start        1368091.93 173211.996   2.968256e+04      1.717994e+04 #> b0.start            173212.00  22071.417   3.729687e+03      2.180600e+03 #> bpl_stringCuba       29682.56   3729.687   3.729549e+03     -6.247565e-05 #> bpl_stringEngland    17179.94   2180.600  -6.247565e-05      2.180519e+03 #> bpl_stringItaly      32424.46   4138.901   3.339027e-05     -3.339027e-05 #> bpl_stringMexico     23930.43   3035.624   1.971969e-05      1.971969e-05 #> bpl_stringPoland     22524.43   2886.899   0.000000e+00      0.000000e+00 #>                   bpl_stringItaly bpl_stringMexico bpl_stringPoland #> log.b.start          3.242446e+04     2.393043e+04     2.252443e+04 #> b0.start             4.138901e+03     3.035624e+03     2.886899e+03 #> bpl_stringCuba       3.339027e-05     1.971969e-05     0.000000e+00 #> bpl_stringEngland   -3.339027e-05     1.971969e-05     0.000000e+00 #> bpl_stringItaly      4.138740e+03    -3.339027e-05     0.000000e+00 #> bpl_stringMexico    -3.339027e-05     3.035496e+03    -1.971969e-05 #> bpl_stringPoland     0.000000e+00    -1.971969e-05     2.886782e+03 #>  #>  #> $results #> # A tibble: 7 × 7 #>   parameter            coef coef_lower coef_upper     hr hr_lower hr_upper #>   <chr>               <dbl>      <dbl>      <dbl>  <dbl>    <dbl>    <dbl> #> 1 gompertz_b         0.0999     0.0979     0.102  NA       NA       NA     #> 2 gompertz_mode     82.2       80.5       83.8    NA       NA       NA     #> 3 bpl_stringCuba    -0.229     -0.270     -0.188   0.796    0.764    0.829 #> 4 bpl_stringEngland -0.130     -0.179     -0.0815  0.878    0.836    0.922 #> 5 bpl_stringItaly   -0.178     -0.217     -0.138   0.837    0.805    0.871 #> 6 bpl_stringMexico  -0.369     -0.412     -0.325   0.692    0.662    0.723 #> 7 bpl_stringPoland  -0.185     -0.229     -0.141   0.831    0.795    0.869 #>"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertztrunc_simu.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Gompertzian death distribution — gompertztrunc_simu","title":"Simulate Gompertzian death distribution — gompertztrunc_simu","text":"Simulate Gompertzian death distribution","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertztrunc_simu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Gompertzian death distribution — gompertztrunc_simu","text":"","code":"gompertztrunc_simu(   n,   formula,   coefs,   dummy = NULL,   sigma = NULL,   seed = NULL,   a0 = 10^-4,   b = 1/10,   verbose = FALSE )"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertztrunc_simu.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Gompertzian death distribution — gompertztrunc_simu","text":"n sample size formula estimation formula coefs named vactors coefficients corresponding true values dummy vector flags coefficient sigma standard deviation variable seed random seed duplicate data a0 Gompertz alpha parameter b Gompertz b parameter verbose print internal check true","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertztrunc_simu.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Gompertzian death distribution — gompertztrunc_simu","text":"data frame simulated death ages covariate values","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/gompertztrunc_simu.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Gompertzian death distribution — gompertztrunc_simu","text":"","code":"gompertztrunc_simu(n=1000, formula = death_age ~ sex + ambient_temp, coefs = c('sex'=-0.8, 'ambient_temp'=0.3), dummy=c(TRUE,FALSE)) #>       death_age sex ambient_temp #>    1:  74.83718   1  -1.01640510 #>    2:  72.64899   0  -0.01725180 #>    3:  88.12123   1  -1.97995289 #>    4:  74.90236   0   0.07058708 #>    5:  68.54440   1  -1.30928349 #>   ---                            #>  996:  82.22508   1   0.38827938 #>  997:  62.95738   0  -0.18481615 #>  998:  56.22529   0  -0.79565485 #>  999:  49.73188   1  -0.21504914 #> 1000:  90.92951   1  -1.17691555"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/hazard_ratio_to_le.html","id":null,"dir":"Reference","previous_headings":"","what":"Translate a single hazard ratio to life expectancy — hazard_ratio_to_le","title":"Translate a single hazard ratio to life expectancy — hazard_ratio_to_le","text":"Translate single hazard ratio life expectancy","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/hazard_ratio_to_le.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Translate a single hazard ratio to life expectancy — hazard_ratio_to_le","text":"","code":"hazard_ratio_to_le(lower, upper, hr, M = 80, b = 0.1)"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/hazard_ratio_to_le.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Translate a single hazard ratio to life expectancy — hazard_ratio_to_le","text":"lower age compute change remaining life expectancy upper upper age bound life table calculations hr hazard ratio M Gompertz modal age death parameter b Gompertz mortality slope parameter","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/hazard_ratio_to_le.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Translate a single hazard ratio to life expectancy — hazard_ratio_to_le","text":"hazard ratio converted effect life expectancy","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/mll.gomp.multi.cohort.cov.html","id":null,"dir":"Reference","previous_headings":"","what":"Gompertz mle function — mll.gomp.multi.cohort.cov","title":"Gompertz mle function — mll.gomp.multi.cohort.cov","text":"Gompertz mle function","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/mll.gomp.multi.cohort.cov.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gompertz mle function — mll.gomp.multi.cohort.cov","text":"","code":"mll.gomp.multi.cohort.cov(p, A, predictors = predictors)"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/mll.gomp.multi.cohort.cov.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gompertz mle function — mll.gomp.multi.cohort.cov","text":"p initialization function data matrix covariates y, u, l, covariates, including cohort","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/mll.gomp.multi.cohort.cov.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gompertz mle function — mll.gomp.multi.cohort.cov","text":"None","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/negLL_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Gompertz Negative Log Likelihood Function — negLL_function","title":"Gompertz Negative Log Likelihood Function — negLL_function","text":"Computes negative log likelihood optimizer","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/negLL_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gompertz Negative Log Likelihood Function — negLL_function","text":"","code":"negLL_function(par, y, X, y.left, y.right, wt)"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/negLL_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gompertz Negative Log Likelihood Function — negLL_function","text":"par vector parameter estimates y vector death ages X model matrix y.left left truncation age y.right right trunction age wt weight","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/negLL_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gompertz Negative Log Likelihood Function — negLL_function","text":"negative log likelihood parameter estimates given observed data","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe — %>%","title":"Pipe — %>%","text":"Put description See magrittr::%>% details.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe — %>%","text":"lhs, rhs specify lhs rhs lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/pipe.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Pipe — %>%","text":"","code":"# some examples if you want to highlight the usage in the package"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/sim_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulated mortality data set — sim_data","title":"Simulated mortality data set — sim_data","text":"data set containing simulated age death covariates according truncated Gompertz distribution proportional hazards","code":""},{"path":"https://caseybreen.github.io/gompertztrunc/reference/sim_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulated mortality data set — sim_data","text":"","code":"sim_data"},{"path":"https://caseybreen.github.io/gompertztrunc/reference/sim_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Simulated mortality data set — sim_data","text":"data frame 6732 rows 6 variables: aod Age death, integer years byear Calender year birth dyear Calender year death temp Temperature sex Sex (0 = male, 1 = female) isSouth Live south (0 = FALSE, 1 = TRUE)","code":""}]
